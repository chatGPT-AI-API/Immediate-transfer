<!DOCTYPE html>
<html>
<head>
    <title>扫码支付</title>
    <style>
        .qr-container { text-align: center; padding: 20px; }
        .qr-code { margin: 20px auto; }
        .payment-info { margin: 10px 0; }
    </style>
</head>
<body>
    <div class="qr-container">
        <h2>扫码支付</h2>
        <div class="payment-info">
            <p>订单号: <span id="order-id">{{ order_id }}</span></p>
            <p>支付金额: <span id="amount">{{ amount }}</span> 元</p>
        </div>
        <div class="qr-code">
            <img id="qr-image" src="{{ qr_code }}" alt="支付二维码">
        </div>
        <p>请使用微信/支付宝扫描上方二维码完成支付</p>
        <button onclick="checkPaymentStatus()">检查支付状态</button>
    </div>
    
    <script>
        function checkPaymentStatus() {
            fetch('/api/check_order_status?order_id=' + document.getElementById('order-id').textContent)
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'paid') {
                        alert('支付成功！');
                        window.location.href = '/payment_callback?order_id=' + document.getElementById('order-id').textContent;
                    } else {
                        alert('支付未完成，请继续扫码支付');
                    }
                });
        }
    </script>
</body>
</html>